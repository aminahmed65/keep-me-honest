# FluidVoice Build Configuration
# Source this file to set optimal build environment

# Build Cache Configuration
export SWIFT_BUILD_CACHE_PATH="$HOME/.swift-build-cache"

# Swift Compiler Optimizations
export SWIFT_EXEC_ARGS="-j$(sysctl -n hw.logicalcpu)"

# Create cache directory
mkdir -p "$SWIFT_BUILD_CACHE_PATH"

# Development aliases for faster builds
alias fv-build="./build-dev.sh"
alias fv-release="CODE_SIGN_IDENTITY='EFC93994F7FFF5A8EC85E5CD41174673C1EDCD25' ./build.sh"
alias fv-test="swift test --parallel --build-path .build-dev"
alias fv-clean="rm -rf .build-dev .build/apple/Products"
alias fv-run="swift run --build-path .build-dev"

# Debug & Logging aliases
alias fv-logs="/usr/bin/log stream --predicate 'subsystem == \"com.fluidvoice.app\"' --info"
alias fv-logs-sudo="sudo /usr/bin/log stream --predicate 'subsystem == \"com.fluidvoice.app\"' --info"
alias fv-kill="pkill -f FluidVoice"
alias fv-start="FluidVoice-dev.app/Contents/MacOS/FluidVoice"
alias fv-debug-audio="defaults write com.fluidvoice.app enableDebugAudioMode -bool true"
alias fv-debug-audio-off="defaults write com.fluidvoice.app enableDebugAudioMode -bool false"

# Build & Run workflow
alias fv-dev="./build-dev.sh 2>&1 | tee build-output.txt"
alias fv-restart="pkill -f FluidVoice; FluidVoice-dev.app/Contents/MacOS/FluidVoice &"

# Utility aliases
alias fv-find-audio="find /var/folders -name 'recording_*.m4a' -type f 2>/dev/null"
alias fv-temp-clean="rm -f /tmp/recording_*.m4a build-output.txt"

echo "ğŸš€ FluidVoice build environment loaded"
echo "   Cache: $SWIFT_BUILD_CACHE_PATH"
echo "   Cores: $(sysctl -n hw.logicalcpu)"
echo ""
echo "ğŸ“¦ Build Commands:"
echo "   fv-build      - Fast development build"
echo "   fv-dev        - Build with output capture"
echo "   fv-release    - Signed release build"
echo "   fv-test       - Run tests"
echo "   fv-clean      - Clean build artifacts"
echo ""
echo "ğŸ› Debug Commands:"
echo "   fv-logs       - Stream app logs"
echo "   fv-logs-sudo  - Stream logs with device names"
echo "   fv-start      - Start app"
echo "   fv-kill       - Kill app"
echo "   fv-restart    - Kill and restart app"
echo ""
echo "ğŸ”§ Utility Commands:"
echo "   fv-debug-audio     - Enable audio debug mode"
echo "   fv-debug-audio-off - Disable audio debug mode"
echo "   fv-find-audio      - Find temp audio files"
echo "   fv-temp-clean      - Clean temp files"